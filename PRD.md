# 테트리스 (Tetris) 프로젝트 PRD

## 1. 개요

| 항목 | 내용 |
|------|------|
| **프로젝트명** | Tetris (테트리스) |
| **버전** | 1.0 |
| **목적** | 브라우저에서 동작하는 클래식 테트리스 게임 + 온라인 최고 기록(리더보드) 제공 |
| **기술 스택** | HTML5, CSS3, JavaScript(ES5+), Canvas API, Supabase(Backend as a Service) |

---

## 2. 제품 목표

- 사용자가 별도 설치 없이 브라우저만으로 테트리를 플레이할 수 있게 한다.
- 점수 기반 낙하 속도 증가로 난이도가 올라가며, 즉시 낙하·월킥 등 현대 테트리스 UX를 반영한다.
- Supabase를 이용해 전역 최고 기록 TOP 10을 저장·표시하고, 쿠키 기반 플레이어 ID로 본인 기록을 강조한다.

---

## 3. 기능 요구사항

### 3.1 게임 플레이

- **보드**: 12×24 칸 (가로 12, 세로 24).
- **블록(테트로미노)**: I, O, T, S, Z, J, L 7종. 각각 고유 색상.
- **조작**
  - ← → : 좌우 이동
  - ↓ : 소프트 드롭(한 칸 아래)
  - ↑ : 회전 (벽/블록과 겹치면 월킥으로 좌우 이동 후 회전 시도)
  - 스페이스: 즉시 낙하(착지 후 좌/우 이동 가능, 락 전 0.5초)
  - P : 일시정지
- **즉시 낙하 후**: 스페이스 추가 입력 불가, 방향키로만 좌/우 너지. 아래로 떨어질 공간이 있으면 락하지 않고 일반 낙하로 전환.
- **라인 클리어**: 한 줄 이상 완성 시 리드미컬 플래시 연출(약 0.48초) 후 해당 줄 제거 및 점수·레벨 반영.

### 3.2 점수·레벨·속도

- **점수**
  - 라인 클리어: 1줄 100, 2줄 300, 3줄 500, 4줄 800 (레벨 배율 적용).
  - 소프트 드롭(↓): +10점.
  - 즉시 낙하: 줄당 2점 × 즉시낙하 배율(반올림).
- **레벨**: 총 라인 10줄마다 1레벨 상승. 레벨에 따라 기본 낙하 간격 단축.
- **낙하 속도(자동 낙하만)**
  - 표시: 100% 기준, 10점당 2% 증가.
  - 공식: `낙하 속도(%) = 100 + floor(점수/10)×2`.
  - 자동 낙하 간격만 이 배율로 단축(유저 키 입력과 무관).
- **즉시 낙하**: 위 낙하 속도 증가의 20%만 반영. 예: 300%일 때 즉시낙하 배율 140%.

### 3.3 리더보드(최고 기록)

- **저장소**: Supabase `tetris_scores` 테이블.
- **저장 데이터**: `player_id`(쿠키 기반 고유 ID), `player_name`, `score`, `created_at`.
- **표시**: 상위 10개를 게임 화면 좌측에 항상 표시. 자신의 기록은 순위 숫자 보라색, 1·2·3위일 때 갈색 강조.
- **플레이어 ID**: 브라우저 쿠키 `tetris_player_id`, 365일 유효. 없으면 자동 생성 후 저장.

### 3.4 게임 흐름·UI

- **대기 화면**: 제목 + 시작 버튼. 스페이스로도 시작 가능.
- **게임 오버**: GAME OVER + 최종 점수 표시 → 1초 락 → 이름 입력(prompt) → Supabase 제출 후 스코어보드 갱신. 스페이스로 다시 시작(1초 이후).
- **헤더**: 낙하 속도(%), 점수, 레벨, 라인.
- **레이아웃**: [스코어보드 TOP 10] [게임 보드] [다음 블록 + 조작법].

---

## 4. 비기능 요구사항

- **실행 환경**: 최신 브라우저(Chrome, Firefox, Edge, Safari 등). 별도 빌드 없이 `index.html` 로컬 또는 정적 호스팅으로 실행.
- **Supabase**: 프로젝트 URL·anon key는 `config.js`에 설정. 테이블·RLS는 `supabase/schema.sql`로 제공.
- **반응형**: 작은 화면에서 스코어보드·패널 배치 조정.

---

## 5. 제외 범위(Out of Scope)

- 로그인/회원가입.
- 실시간 멀티플레이.
- 모바일 터치 전용 조작(현재 키보드 기준).
- 소리·BGM.

---

## 6. 파일 구조

```
tetris/
├── index.html      # 진입점, 구조·스크립트 로드
├── style.css       # 스타일·반응형
├── config.js       # Supabase URL·anon key
├── game.js         # 게임 로직·Supabase 연동
├── PRD.md          # 본 문서
├── readme.txt      # 사용자 매뉴얼
└── supabase/
    └── schema.sql  # tetris_scores 테이블·RLS 정의
```

---

## 7. 변경 이력

| 버전 | 날짜 | 변경 내용 |
|------|------|-----------|
| 1.0 | - | 초기 PRD 작성: 플레이, 점수/속도, 리더보드, 쿠키 ID, UI 흐름 정의 |
